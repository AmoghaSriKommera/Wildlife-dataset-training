# -*- coding: utf-8 -*-
"""wildlife_dataset_training.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1uYnFJgfixs83Zn39YtcblNse2NaY1-5G
"""

from google.colab import drive
drive.mount('/content/drive')

!unzip /content/drive/MyDrive/wildlife_dataset_training.zip -d /content/

!pip install ultralytics

# Commented out IPython magic to ensure Python compatibility.
# %%writefile /content/wildlife_dataset_training/data.yaml
# train: /content/wildlife_dataset_training/african-wildlife/train/images
# val: /content/wildlife_dataset_training/african-wildlife/val/images
# 
# nc: 5
# names: ['lion', 'elephant', 'zebra', 'giraffe', 'rhino']  # adjust if neede

!ls /content/wildlife_dataset_training/african-wildlife/val/images

from ultralytics import YOLO

model = YOLO('yolov8n.pt')
model.train(data='/content/wildlife_dataset_training/data.yaml', epochs=12, imgsz=640)

!ls -R /content/runs/detect/

!cp /content/runs/detect/train4/weights/best.pt /content/best.pt

from ultralytics import YOLO

model = YOLO('/content/runs/detect/train4/weights/best.pt')
metrics = model.val()

# Access mAP, precision, recall, etc.
print(metrics.box.map)         # mAP@0.5
print(metrics.box.map50)       # mAP@0.5
print(metrics.box.map75)       # mAP@0.75
print(metrics.box.maps)        # mAP for each class